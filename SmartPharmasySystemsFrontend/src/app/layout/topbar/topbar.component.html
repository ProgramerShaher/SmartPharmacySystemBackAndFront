<!-- topbar.component.html -->
<div class="topbar-content">

    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" (click)="toggleSidebar()" pTooltip="القائمة" tooltipPosition="bottom">
        <i class="pi pi-bars text-lg"></i>
    </button>

    <!-- Search -->
    <div class="search-container">
        <div class="search-wrapper">
            <i class="pi pi-search search-icon mr-2"></i>
            <input type="text" placeholder="ابحث عن دواء، فاتورة، عميل..." [(ngModel)]="searchQuery"
                (keyup.enter)="onSearch()">
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions-menu">
        <button class="quick-action-btn" (click)="navigateTo('/inventory/medicines/add')">
            <i class="pi pi-plus"></i>
            <span>دواء جديد</span>
        </button>
        <button class="quick-action-btn" (click)="navigateTo('/sales/create')">
            <i class="pi pi-receipt"></i>
            <span>فاتورة جديدة</span>
        </button>
    </div>

    <!-- Actions -->
    <div class="actions-section">
        <!-- Theme Switcher -->
        <button class="action-btn" pTooltip="تغيير الوضع" tooltipPosition="bottom" (click)="themeService.toggleTheme()">
            <i class="pi" [ngClass]="themeService.currentThemeValue === 'dark' ? 'pi-sun' : 'pi-moon'"></i>
        </button>

        <!-- Notifications -->
        <button class="action-btn" pTooltip="الإشعارات" tooltipPosition="bottom" (click)="toggleNotifications()">
            <i class="pi pi-bell"></i>
            <span class="notification-badge" *ngIf="hasNotifications"></span>
        </button>

        <!-- User Profile -->
        <div class="user-profile" (click)="toggleUserMenu($event, userMenu)">
            <div class="user-avatar">
                <img [src]="userAvatar" alt="المستخدم">
            </div>
            <div class="user-info">
                <span class="user-name">{{userName}}</span>
                <span class="user-role">{{userRole}}</span>
            </div>
        </div>

        <!-- Logout -->
        <button class="action-btn logout-btn" pTooltip="تسجيل الخروج" tooltipPosition="bottom"
            (click)="confirmLogout()">
            <i class="pi pi-power-off"></i>
        </button>
    </div>

</div>

<!-- Notifications Panel -->
<p-overlayPanel #notificationsPanel>
    <div class="notifications-panel p-3" style="width: 320px">
        <div class="flex align-items-center justify-content-between mb-3">
            <h4 class="m-0">الإشعارات</h4>
            <button class="p-link text-sm">تحديد الكل كمقروء</button>
        </div>
        <!-- Notifications List -->
    </div>
</p-overlayPanel>

<!-- User Menu -->
<p-menu #userMenu [model]="userMenuItems" [popup]="true"></p-menu>

<!-- Logout Confirmation -->
<p-confirmDialog></p-confirmDialog>