<p-sidebar [(visible)]="visible" (onHide)="close()" position="left" styleClass="w-full md:w-30rem lg:w-40rem p-0"
    [modal]="true" [blockScroll]="true">
    <ng-template pTemplate="header">
        <div class="flex align-items-center gap-2">
            <span class="w-2rem h-2rem border-circle bg-teal-50 flex align-items-center justify-content-center">
                <i class="pi" [ngClass]="medicine ? 'pi-pencil text-teal-600' : 'pi-plus text-teal-600'"></i>
            </span>
            <span class="font-bold text-xl">{{ medicine ? 'ุชุนุฏูู ุฏูุงุก' : 'ุฅุถุงูุฉ ุฏูุงุก ุฌุฏูุฏ' }}</span>
        </div>
    </ng-template>
    
    <div class="flex flex-column h-full">
        <div class="flex-grow-1 overflow-y-auto px-4 pb-4">
            <form [formGroup]="medicineForm" class="grid p-fluid mt-2">
    
                <!-- Basic Info Section -->
                <div class="col-12 text-sm text-500 font-bold mb-2">๐ ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ</div>
    
                <div class="col-12">
                    <label class="block font-bold mb-2 required-star">ุงูุงุณู ุงูุชุฌุงุฑู</label>
                    <input pInputText formControlName="name"
                        [ngClass]="{'ng-invalid ng-dirty': medicineForm.get('name')?.invalid && medicineForm.get('name')?.touched}" />
                    <small class="text-red-500 block mt-1"
                        *ngIf="medicineForm.get('name')?.invalid && medicineForm.get('name')?.touched">ุงูุงุณู ูุทููุจ</small>
                </div>
<div class="col-12 md:col-6">
    <label class="block font-bold mb-2">ุงูููุฏ ุงูุฏุงุฎูู</label>
    <input pInputText formControlName="internalCode" placeholder="ุชููุงุฆู" />
                </div>
<div class="col-12 md:col-6">
    <label class="block font-bold mb-2">ุงูุจุงุฑููุฏ</label>
    <div class="p-inputgroup">
        <span class="p-inputgroup-addon"><i class="pi pi-barcode"></i></span>
        <input pInputText formControlName="defaultBarcode" />
    </div>
</div>

                <div class="col-12 md:col-6">
                    <label class="block font-bold mb-2">ุงูุงุณู ุงูุนููู</label>
                    <input pInputText formControlName="scientificName" />
                </div>
<div class="col-12 md:col-6">
    <label class="block font-bold mb-2">ุงูุชุตููู</label>
    <p-dropdown [options]="categories" formControlName="categoryId" optionLabel="name" optionValue="id"
        placeholder="ุงุฎุชุฑ ุงูุชุตููู" [filter]="true" [showClear]="true"></p-dropdown>
                </div>

                <div class="col-12 md:col-6">
                    <label class="block font-bold mb-2">ุงูุดุฑูุฉ ุงููุตูุนุฉ</label>
                    <input pInputText formControlName="manufacturer" />
                </div>
<div class="col-12 md:col-6" *ngIf="medicine">
    <label class="block font-bold mb-2">ุงูุญุงูุฉ</label>
    <p-dropdown [options]="statusOptions" formControlName="status" optionLabel="label" optionValue="value">
        <ng-template pTemplate="selectedItem" let-selected>
            <p-tag [value]="selected.label" [severity]="selected.value === 'Active' ? 'success' : 'danger'"></p-tag>
        </ng-template>
        <ng-template pTemplate="item" let-item>
            <p-tag [value]="item.label" [severity]="item.value === 'Active' ? 'success' : 'danger'"></p-tag>
        </ng-template>
    </p-dropdown>
                </div>

                <div class="col-12">
                    <div class="border-top-1 border-200 my-2"></div>
                </div>
                <!-- Price Section -->
                <div class="col-12 text-sm text-500 font-bold mb-2">๐ฐ ุงูุชุณุนูุฑ (ุงูุนููุฉ ุงูุฃุณุงุณูุฉ)</div>
                
                <div class="col-12 md:col-6">
                    <label class="block font-bold mb-2 required-star">ุณุนุฑ ุงูุดุฑุงุก</label>
                    <p-inputNumber formControlName="defaultPurchasePrice" mode="decimal" [minFractionDigits]="0" [maxFractionDigits]="2"
                        suffix=" ุฑ.ู"></p-inputNumber>
                </div>
<div class="col-12 md:col-6">
    <label class="block font-bold mb-2 required-star">ุณุนุฑ ุงูุจูุน</label>
    <p-inputNumber formControlName="defaultSalePrice" mode="decimal" [minFractionDigits]="0" [maxFractionDigits]="2"
        suffix=" ุฑ.ู"></p-inputNumber>
    <small class="text-red-500 block mt-1"
        *ngIf="medicineForm.errors?.['invalidPrice'] && (medicineForm.touched || medicineForm.dirty)">
        ุณุนุฑ ุงูุจูุน ุฃูู ูู ุงูุดุฑุงุก!
    </small>
                </div>
<div class="col-12">
    <div class="border-top-1 border-200 my-2"></div>
</div>

<!-- Inventory Section -->
<div class="col-12 text-sm text-500 font-bold mb-2">๐ฆ ุฅุนุฏุงุฏุงุช ุงููุฎุฒูู</div>

<div class="col-12 md:col-6">
    <label class="block font-bold mb-2">ุญุฏ ุงูุชูุจูู (ุชูุจูู ุจุงูููุต)</label>
    <p-inputNumber formControlName="minAlertQuantity" [showButtons]="true" [min]="0"></p-inputNumber>
</div>
<div class="col-12 md:col-6">
    <label class="block font-bold mb-2">ูุณุชูู ุฅุนุงุฏุฉ ุงูุทูุจ</label>
    <p-inputNumber formControlName="reorderLevel" [showButtons]="true" [min]="0"></p-inputNumber>
</div>
<div class="col-12 md:col-6 flex align-items-center mt-3">
    <p-checkbox formControlName="soldByUnit" [binary]="true" inputId="soldByUnit"></p-checkbox>
    <label for="soldByUnit" class="mr-2 cursor-pointer select-none">ูุจุงุน ุจุงููุญุฏุฉ (ูููุณ ุจุงูุนูุจุฉ)</label>
</div>

                <div class="col-12 mt-3">
                    <label class="block font-bold mb-2">ููุงุญุธุงุช ุฅุถุงููุฉ</label>
                    <textarea pInputTextarea formControlName="notes" rows="3" class="w-full"></textarea>
                </div>
                </form>
                </div>
<div class="flex justify-content-end p-4 border-top-1 border-200 bg-gray-50 gap-2">
    <button pButton label="ุฅูุบุงุก" icon="pi pi-times" class="p-button-outlined p-button-secondary"
        (click)="close()"></button>
    <button pButton [label]="medicine ? 'ุญูุธ ุงูุชุนุฏููุงุช' : 'ุฅุถุงูุฉ ุฏูุงุก'" icon="pi pi-check"
        class="p-button-raised p-button-success" [loading]="loading" (click)="save()"
        [disabled]="medicineForm.invalid"></button>
        </div>
    </div>
    </p-sidebar>