<div class="card p-0" dir="rtl">
    <div class="flex flex-column h-full">
        <!-- Header -->
        <div class="flex justify-content-between align-items-center p-3 border-bottom-1 surface-border bg-gray-50">
            <div class="flex align-items-center gap-2">
                <div
                    class="w-3rem h-3rem border-circle bg-primary-50 flex align-items-center justify-content-center text-primary">
                    <i class="pi pi-briefcase text-xl"></i>
                </div>
                <div>
                    <h2 class="text-lg font-bold m-0">{{ editMode ? 'تعديل بيانات الفئة' : 'إضافة فئة جديدة' }}</h2>
                    <p class="text-sm text-500 m-0" *ngIf="editMode">تعديل بيانات: {{ categoryData?.name }}</p>
                    <p class="text-sm text-500 m-0" *ngIf="!editMode">إدخال بيانات تصنيف دوائي جديد</p>
                </div>
                </div>
            <button pButton icon="pi pi-times" class="p-button-rounded p-button-text p-button-secondary"
                (click)="cancel()"></button>
            </div>

        <!-- Form Content -->
        <div class="p-4 overflow-y-auto" style="max-height: 60vh;">
            <form [formGroup]="categoryForm" class="grid p-fluid">
                <!-- Basic Info -->
                <div class="col-12">
                    <label class="block font-bold mb-2 required-label">اسم الفئة</label>
                    <span class="p-input-icon-left w-full">
                        <i class="pi pi-tag"></i>
                        <input pInputText formControlName="name" placeholder="مثلاً: مضادات حيوية، مسكنات..."
                            [ngClass]="{'ng-invalid ng-dirty': name.invalid && name.touched}" />
                        </span>
                        <small *ngIf="name.invalid && name.touched" class="p-error block mt-1">
                            <ng-container *ngIf="name.errors?.['required']">اسم الفئة مطلوب</ng-container>
                            <ng-container *ngIf="name.errors?.['minlength']">يجب أن يحتوي الاسم على حرفين على الأقل</ng-container>
                        </small>
                        </div>

                <div class="col-12">
                    <label class="block font-bold mb-2">الوصف (اختياري)</label>
                    <textarea pInputTextarea formControlName="description" rows="4" placeholder="اكتب وصفاً مختصراً للفئة..."
                        [autoResize]="true"></textarea>
                    <small class="text-500 block text-left mt-1">{{ description.value?.length || 0 }}/500</small>
                </div>

            </form>
            </div>

        <!-- Footer Actions -->
        <div class="p-3 border-top-1 surface-border flex justify-content-end gap-2 bg-gray-50">
            <button pButton label="إلغاء" icon="pi pi-times" class="p-button-outlined p-button-secondary w-auto"
                (click)="cancel()"></button>
            <button pButton [label]="saving ? 'جاري الحفظ...' : (editMode ? 'حفظ التعديلات' : 'إضافة الفئة')" icon="pi pi-check"
                class="p-button-primary w-auto" (click)="saveCategory()" [disabled]="categoryForm.invalid || saving"
                [loading]="saving"></button>
        </div>
    </div>
</div>