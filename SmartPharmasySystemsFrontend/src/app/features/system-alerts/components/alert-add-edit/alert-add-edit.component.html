<div class="compact-square-card">
    <!-- Header -->
    <div class="card-header">
      <div class="header-title">
        <i class="pi" [class]="isEditMode ? 'pi-pencil' : 'pi-plus-circle'"></i>
        <h3>{{ isEditMode ? 'تعديل التنبيه' : 'إضافة تنبيه جديد' }}</h3>
      </div>
        <p-tag *ngIf="isEditMode" value="تعديل" severity="warning" [rounded]="true"></p-tag>
    </div>

    <!-- Body (Scrollable interior if needed, but designed to fit) -->
    <div class="card-body">
      <form [formGroup]="alertForm" (ngSubmit)="onSubmit()">
            <div class="form-grid">
            
              <!-- Row 1 -->
              <div class="field-wrapper col-span-1">
                <label class="field-label">نوع التنبيه</label>
                <p-dropdown [options]="alertTypeOptions" formControlName="alertType" [autoDisplayFirst]="false" appendTo="body"
                  placeholder="اختر النوع">
                  <ng-template pTemplate="selectedItem" let-selected>
                    <div class="flex align-items-center gap-2" *ngIf="selected">
                      <i [class]="getAlertTypeIcon(selected.value)" class="text-primary text-sm"></i>
                      <span class="text-sm font-bold">{{ selected.label }}</span>
                    </div>
                  </ng-template>
                </p-dropdown>
                </div>

                <div class="field-wrapper col-span-1">
                  <label class="field-label">الحالة</label>
                  <p-dropdown [options]="statusOptions" formControlName="status" [autoDisplayFirst]="true" appendTo="body"></p-dropdown>
                </div>

                <div class="field-wrapper col-span-1">
                  <label class="field-label">رقم الدفعة</label>
                  <input type="text" pInputText formControlName="batchNumber" placeholder="BATCH-001" />
                </div>

                <!-- Row 2 -->
                <div class="field-wrapper col-span-1">
                  <label class="field-label">الدواء</label>
                  <input type="text" pInputText formControlName="medicineName" placeholder="اسم الدواء..." />
                </div>

                <div class="field-wrapper col-span-1">
                  <label class="field-label">تاريخ التفعيل</label>
                  <p-calendar formControlName="executionDate" dateFormat="yy/mm/dd" [showIcon]="true" appendTo="body"></p-calendar>
                </div>

                <div class="field-wrapper col-span-1">
                  <label class="field-label">تاريخ الانتهاء</label>
                  <p-calendar formControlName="expiryDate" dateFormat="yy/mm/dd" [showIcon]="true" appendTo="body"></p-calendar>
                </div>

                <!-- Row 3: Message (Full Width) -->
                <div class="field-wrapper col-12">
                  <label class="field-label">نص التنبيه <span class="text-red-500">*</span></label>
                  <textarea pInputTextarea formControlName="message" rows="3" placeholder="أدخل رسالة التنبيه هنا..."></textarea>
                </div>

            </div>
        </form>
    </div>
<!-- Footer -->
<div class="card-footer">
  <button pButton type="button" label="إلغاء الأمر" class="p-button-secondary" (click)="onCancel()"></button>
  <button pButton type="button" [label]="isEditMode ? 'حفظ التعديلات' : 'إضافة الآن'" icon="pi pi-check"
    (click)="onSubmit()" [loading]="loading"></button>
    </div>

</div>
<p-toast></p-toast>